<!DOCTYPE html>
<!--              ___           ___           ___           ___     
    ___          /  /\         /  /\         /  /\         /  /\    
   /  /\        /  /:/_       /  /::\       /  /::\       /  /:/    
  /  /:/       /  /:/ /\     /  /:/\:\     /  /:/\:\     /  /:/     
 /__/::\      /  /:/ /::\   /  /:/~/::\   /  /:/~/::\   /  /:/  ___ 
 \__\/\:\__  /__/:/ /:/\:\ /__/:/ /:/\:\ /__/:/ /:/\:\ /__/:/  /  /\
    \  \:\/\ \  \:\/:/~/:/ \  \:\/:/__\/ \  \:\/:/__\/ \  \:\ /  /:/
     \__\::/  \  \::/ /:/   \  \::/       \  \::/       \  \:\  /:/ 
     /__/:/    \__\/ /:/     \  \:\        \  \:\        \  \:\/:/  
     \__\/       /__/:/       \  \:\        \  \:\        \  \::/   
                 \__\/         \__\/         \__\/         \__\/ -->
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <title>Django Feed Enclosures</title>
        <meta name="author" content="Isaac Bythewood"/>
        <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lobster|Vollkorn:400italic,400"/>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/normalize/2.1.0/normalize.min.css"/>
        <link rel="stylesheet" href="../../../../theme/css/codehilite.css"/>
        <link rel="stylesheet" href="../../../../theme/css/base.css"/>
    </head>

    <body>
        <div id="wrapper">
        <div id="header">
            <a href="../../../..">
                <div id="name">Isaac Bythewood</div>
                <div id="description">I am a website developer located in Morganton, NC</div>
            </a>
        </div>
<div class="section">
    <div class="title">
        <h3>Article</h3>
    </div>
    <div class="content">
        <h1>Django Feed Enclosures</h1>
        <h2 class="date">30 Apr 2012 - Coding</h2>
        <p>Are probably one of the most painful things I've worked with because they don't
properly append the domain name to the enclosure slug which doesn't help anyone
pulling your feed because they need the full domain name to grab the media. I
applied a <a class="reference external" href="https://github.com/pinry/pinry/blob/a4f3adc2dfaf6666da53d56df17667e40d6a6daa/pinry/core/feeds.py">hacky fix for it in Pinry</a>.</p>
<p>Here's a code snippet of what I did:</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.syndication.views</span> <span class="kn">import</span> <span class="n">Feed</span>
<span class="kn">from</span> <span class="nn">django.contrib.sites.models</span> <span class="kn">import</span> <span class="n">get_current_site</span>

<span class="k">class</span> <span class="nc">LatestPins</span><span class="p">(</span><span class="n">Feed</span><span class="p">):</span>

  <span class="n">domain_name</span> <span class="o">=</span> <span class="bp">None</span>

  <span class="k">def</span> <span class="nf">get_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
     <span class="n">request_type</span> <span class="o">=</span> <span class="s">&#39;http&#39;</span>
     <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_secure</span><span class="p">():</span> <span class="n">request_type</span> <span class="o">=</span> <span class="s">&#39;https&#39;</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">domain_name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">request_type</span><span class="p">,</span> <span class="s">&#39;://&#39;</span><span class="p">,</span> <span class="n">get_current_site</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">domain</span><span class="p">])</span>

  <span class="k">def</span> <span class="nf">item_enclosure_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
     <span class="n">slug</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">url</span>
     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_name</span> <span class="o">+</span> <span class="n">slug</span>
</pre></div>
<!-- Links -->

    </div>
</div>
<div class="section">
    <div class="title">
        <h3>Links</h3>
    </div>
    <div class="content">
        <ul id="links">
            <li>
            <a href="https://github.com/overshard" target="_blank">
                <h4>GitHub</h4>
                <h5>my code</h4>
            </a>
            </li>
            <li>
            <a href="http://goodreads.com/overshard" target="_blank">
                <h4>Goodreads</h4>
                <h5>my books</h4>
            </a>
            </li>
            <li>
            <a href="http://steamcommunity.com/id/overshard/" target="_blank">
                <h4>Steam</h4>
                <h5>my games</h4>
            </a>
            </li>
            <li>
            <a href="http://getpinry.com/" target="_blank">
                <h4>Pinry</h4>
                <h5>my baby</h4>
            </a>
            </li>
            <li>
            <a href="http://vannoppen.co/" target="_blank">
                <h4>VanNoppen</h4>
                <h5>my work</h4>
            </a>
            </li>
            <li>
            <a href="mailto:isaac@bythewood.me" target="_blank">
                <h4>Email</h4>
                <h5>my ... email</h4>
            </a>
            </li>
        </ul>
    </div>
</div>        <div id="footer">
            <p>Content copyright Â© 2013 Isaac Bythewood under the
                <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons</a>
                license.</p>
            <p>The code for this website can be found on
                <a href="https://github.com/overshard/isaacbythewood.com">GitHub</a>.</p>
        </div>
        </div>
<script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(["trackPageView"]);
    _paq.push(["enableLinkTracking"]);

    (function() {
        var u=(("https:" == document.location.protocol) ? "https" : "http") + "://analytics.bythewood.me/";
        _paq.push(["setTrackerUrl", u+"piwik.php"]);
        _paq.push(["setSiteId", "1"]);
        var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
        g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
    })();
</script>    </body>
</html>